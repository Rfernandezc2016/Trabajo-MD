---
title: "MINERIA DE DATOS"
author: "Rocío Fernández Cebrián"
date: "29/9/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```







```{r graficos}
library(psych)

pairs.panels(datos.setas_train[,c(1,6)],method = "pearson",hist.col = "#00AFBB",density = TRUE,ellipses = TRUE)

pairs(datos.setas_train[,c(1:5)])

```

```{r pruebas test}
table(datos.setas_train$Letalidad,datos.setas_train$Forma_S)
chisq.test(table(datos.setas_train$Letalidad,datos.setas_train$Forma_S))
```



CALCULO DE DISTANCIAS
```{r funcion distancias}
#Distancia Dice:
dist.dice=function(a,b,c,d,matriz,i,j){
  distancia=(2*a)/(2*a+b+c)
  matriz[j,i]=distancia
  matriz[i,j]=distancia
  matriz
}
#Distancia Hamman:
dist.hamman=function(a,b,c,d,matriz,i,j){
  distancia=((a+d)-(b+c))/(a+b+c+d)
  matriz[j,i]=distancia
  matriz[i,j]=distancia
  matriz
}
#Distancia Pearson:
dist.pearson=function(a,b,c,d,matriz,i,j){
  distancia=(a*d)/sqrt((a+b)*(a+c)*(b+d)*(c+d))
  matriz[j,i]=distancia
  matriz[i,j]=distancia
  matriz
}
#Distancia Yule:
dist.yule=function(a,b,c,d,matriz,i,j){
  distancia=((a*d)-(b*c))/((a*d)+(b*c))
  matriz[j,i]=distancia
  matriz[i,j]=distancia
  matriz
}


#Matrices de las distintas distancias:
distancia_dice=diag(dim(setas)[1])
distancia_hamman=diag(dim(setas)[1])
distancia_pearson=diag(dim(setas)[1])
distancia_yule=diag(dim(setas)[1])
```


```{r distancias}
#i observacion1, j observacion2, k caracteristica
distancias=function(i,j,setas){
    a=0
    b=0
    c=0
    d=0
    for (k in 1:dim(setas)[2]) {
      if(setas[i,k]==1 & setas[j,k]==1){
        a=a+1
      }
      if(setas[i,k]==1 & setas[j,k]==0){
        b=b+1
      }
      if(setas[i,k]==0 & setas[j,k]==1){
        c=c+1
      }
      if(setas[i,k]==0 & setas[j,k]==0){
        d=d+1
      }
    }
    distancia_dice=dist.dice(a,b,c,d,distancia_dice,i,j)
    distancia_hamman=dist.hamman(a,b,c,d,distancia_hamman,i,j)
    distancia_pearson=dist.pearson(a,b,c,d,distancia_pearson,i,j)
    distancia_yule=dist.yule(a,b,c,d,distancia_yule,i,j)
}


#i observacion1, j observacion2, k caracteristica
for (i in 1:(dim(setas)[1]-1)){
  for (j in (i+1):(dim(setas)[1])) {
    a=0
    b=0
    c=0
    d=0
    for (k in 1:dim(setas)[2]) {
      if(setas[i,k]==1 & setas[j,k]==1){
        a=a+1
      }
      if(setas[i,k]==1 & setas[j,k]==0){
        b=b+1
      }
      if(setas[i,k]==0 & setas[j,k]==1){
        c=c+1
      }
      if(setas[i,k]==0 & setas[j,k]==0){
        d=d+1
      }
    }
    distancia_dice=dist.dice(a,b,c,d,distancia_dice,i,j)
    distancia_hamman=dist.hamman(a,b,c,d,distancia_hamman,i,j)
    distancia_pearson=dist.pearson(a,b,c,d,distancia_pearson,i,j)
    distancia_yule=dist.yule(a,b,c,d,distancia_yule,i,j)
  }
}
```


```{r distancias prueba}
dim_prueba=100

#Matrices de las distintas distancias:
distancia_dice=diag(dim_prueba)
distancia_hamman=diag(dim_prueba)
distancia_pearson=diag(dim_prueba)
distancia_yule=diag(dim_prueba)


#i observacion1, j observacion2, k caracteristica
for (i in 1:(dim_prueba-1)){
  for (j in (i+1):(dim_prueba)) {
    a=0
    b=0
    c=0
    d=0
    for (k in 1:dim(setas)[2]) {
      if(setas[i,k]==1 & setas[j,k]==1){
        a=a+1
      }
      if(setas[i,k]==1 & setas[j,k]==0){
        b=b+1
      }
      if(setas[i,k]==0 & setas[j,k]==1){
        c=c+1
      }
      if(setas[i,k]==0 & setas[j,k]==0){
        d=d+1
      }
    }
    distancia_dice=dist.dice(a,b,c,d,distancia_dice,i,j)
    distancia_hamman=dist.hamman(a,b,c,d,distancia_hamman,i,j)
    distancia_pearson=dist.pearson(a,b,c,d,distancia_pearson,i,j)
    distancia_yule=dist.yule(a,b,c,d,distancia_yule,i,j)
  }
}

```

