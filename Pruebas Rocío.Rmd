---
title: "MINERIA DE DATOS"
author: "Rocío Fernández Cebrián"
date: "29/9/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```




ANALISIS CLUSTER
```{r cluster}
clusters2.datos=kmeans(nuevos.datos.pca,centers=2,nstart=25)
#Números de clusters
SSW <- vector(mode = "numeric", length = 15)
n=dim(nuevos.datos.pca)[1]
#Variabilidad de todos los datos, es decir, todos los datos como un único cluster
SSW[1] <- (n - 1) * sum(apply(setas,2,var)) 

#Variabilidad de cada modelo, desde 2 clusters hasta 15 clusters
for (i in 2:15) SSW[i] <- sum(kmeans(setas,centers=i,nstart=25)$withinss)

#Dibujamos un gráfico con el resultado
plot(1:15, SSW, type="b", xlab="Number of Clusters", ylab="Sum of squares within groups",pch=19, col="steelblue4")


#Cluster con 5 centroides:
clusters8.datos=kmeans(setas,centers=8,nstart=25)
centroides=aggregate(setas,by=list(clusters8.datos$cluster),FUN=mean) 

pairs(setas,col= clusters8.datos$cluster,pch=19)
points(clusters8.datos$centers, col = 1:nk, pch = 19, cex=2)


library(cluster)
clusplot(setas, clusters8.datos$cluster, color=TRUE, shade=TRUE, labels=2,lines=0)
```

CALCULO DE DISTANCIAS
```{r funcion distancia dice}

#Matriz de distancia:
library(philentropy)
distancia_dice=distance(setas[,2:117],method="dice")
```



