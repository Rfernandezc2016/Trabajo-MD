---
title: "MINERIA DE DATOS"
author: "Rocío Fernández Cebrián"
date: "29/9/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```



```{r graficos}
library(psych)
pairs.panels(datos.setas_train[,c(1,6)],method = "pearson",hist.col = "#00AFBB",density = TRUE,ellipses = TRUE)
pairs(datos.setas_train[,c(1:5)])
```

```{r PCA}
pca=prcomp(setas)
summary(pca)
plot(pca)
```



CALCULO DE DISTANCIAS
```{r funcion distancia dice}
#Distancia Dice:
dist.dice=function(i,j){
    a=sum(i*j)
    d=sum((1-i)*(1-j))
    
    k=length(i)
    
 return ((2*a)/(a+(k-d)))
}
#Matriz de distancias:
distancia_dice=diag(dim(setas)[1])

#i observacion1, j observacion2, k caracteristica
i=1
n=dim(setas)[1]
while(i<n){
  j=i+1
  while(j<=n) {
    distancia_dice[i,j]=dist.dice(setas[i,],setas[j,])
    distancia_dice[j,i]=distancia_dice[i,j]
    j=j+1
  }
  i=i+1
}



```


```{r otras distancias}

#Distancia Hamman:
dist.hamman=function(a,b,c,d,matriz,i,j){
  distancia=((a+d)-(b+c))/(a+b+c+d)
  matriz[j,i]=distancia
  matriz[i,j]=distancia
  matriz
}
#Distancia Pearson:
dist.pearson=function(a,b,c,d,matriz,i,j){
  distancia=(a*d)/sqrt((a+b)*(a+c)*(b+d)*(c+d))
  matriz[j,i]=distancia
  matriz[i,j]=distancia
  matriz
}
#Distancia Yule:
dist.yule=function(a,b,c,d,matriz,i,j){
  distancia=((a*d)-(b*c))/((a*d)+(b*c))
  matriz[j,i]=distancia
  matriz[i,j]=distancia
  matriz
}


#Matriz de distancias:
distancia_hamman=diag(dim(setas)[1])
distancia_pearson=diag(dim(setas)[1])
distancia_yule=diag(dim(setas)[1])


    distancia_hamman=dist.hamman(a,b,c,d,distancia_hamman,i,j)
    distancia_pearson=dist.pearson(a,b,c,d,distancia_pearson,i,j)
    distancia_yule=dist.yule(a,b,c,d,distancia_yule,i,j)
```


```{r distancias prueba}
dim_prueba=500

#Matrices de las distintas distancias:
distancia_dice=diag(dim_prueba)
distancia_hamman=diag(dim_prueba)
distancia_pearson=diag(dim_prueba)
distancia_yule=diag(dim_prueba)

inicio=Sys.time()
#i observacion1, j observacion2, k caracteristica
i=1
while(i<=(dim_prueba-1)){
  j=i+1
  while(j<=dim_prueba) {
    a=0
    b=0
    c=0
    d=0
    k=1
    while(k<=dim(setas)[2]) {
      if(i[k]==1 & j[k]==1){
        a=a+1
      }
      if(i[k]==1 & j[k]==0){
        b=b+1
      }
      if(i[k]==0 & j[k]==1){
        c=c+1
      }
      if(i[k]==0 & j[k]==0){
        d=d+1
      }
      k=k+1
    }
    distancia_dice=dist.dice(i,j)
    j=j+1
  }
  i=i+1
}
fin=Sys.time()
fin-inicio
```

