---
title: "Memoria del trabajo"
author: "Adrián Rocha De la Casa, Yassin Khalifa Martino y Rocío Fernández Cebrián"
date: "5/10/2021"
output: bookdown::gitbook
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#  Introducción

Este conjunto de datos incluye descripciones de muestras hipotéticas basándose en carracterísticas de hongos de la familia Agaricus y Lepiota.

Para visualizar mejor nuestro análisis necesitamos cargar las siguientes librerías:
```{r librerias,echo=TRUE,warning=FALSE}
library(ggplot2)
```

# ¿ Objetivos (del negocio)?

Nuestro objetivo será identifcar cada especie como una especie comestible o una especie venenosa/de comestibilidad desconocida.

#  Datos 

Leemos los datos mediante el siguiente comando:
```{r introduccion datos,echo=TRUE}
datos.setas<-read.table("agaricus-lepiota.data",header=FALSE,sep=",")
```

Comprobamos que se han leído correctamente los datos mirando la dimensión de los datos.
```{r dimension,echo=TRUE}
dim(datos.setas)
```

Como ya hemos visto, disponemos de 8124 observaciones de setas de las cuales hemos recogido información sobre 23 características.

Realizamos una exploración básica de los datos para comprobar que tipo de datos disponemos.
```{r tipo de variables, echo=TRUE}
summary(datos.setas)
```
Luego son variables cualitativas y por tanto habrá que tratarlas como factores. Estas variables son:


 NOMBRE VARIABLE | DESCRIPCIÓN
 --------------- | ------------
  Letalidad      | venenosa (p) o comestible(e)
  Forma del sombrebro o píleo | campana (b), cónica (c), convexa (x), plana (f), nudosa (k) o hundida (s)
  Cutícula o superficie del sombrero | fibroso (f), con surcos (g), escamosa (y) o lisa (s)
  Color del sombrero | marrón (n), ante (b), canela (c), gris (g), verde (r), rosa (p), morado (u), rojo (e), blanco (w) o amarillo (y)
  Escamas | verdadero (t) o falso (f)
  Olor | almendra (a), anís (l), creosota (c), pescado (y), asqueroso (f), mohoso (m), ninguno (n), acre(p) o picante (s)
  Fijación de las láminas | adjunto (a), descentente (d), libre (f) o entallado (n)
  Espacio entre láminas | cerca (c), atestado (w) o distante (d)
  Tamaño de las láminas | ancho (b) o estrecho (n)
  Color de las láminas | negro (k), marrón (n), ante (b), chocolate (h), gris (g), verde (r), naranja (o), rosa (p), morado (u), rojo (e), blanco (w) o amarillo (y)
  Forma del tallo | agrandado (e) o afilado (t)
  Tallo-raíz | bulboso (b), club (c), copa (u), igual (e), rizomorfos (z), enraizado (r) o faltante (?)
  Superficie del tallo por encima del anillo | fibroso (f), escamoso (y), sedoso (k) o liso (s)
  Superficie del tallo por debajo del anillo | fibroso (f), escamoso (y), sedoso (k) o liso (s)
  Color del tallo por encima del anillo | marrón (n), ante (b), canela (c), gris (g), naranja (o), rosa (p), rojo (e), blanco (w) o amarillo (y)
  Color del tallo por debajo del anillo | marrón (n), ante (b), canela (c), gris (g), naranja (o), rosa (p), rojo (e), blanco (w) o amarillo (y)
  Tipo de volva | parcial (p) o universal (u)
  Color del volva | marrón (n), naranja (o), blanco (w) o amarillo (y)
  Número de anillos | ninguno (n), uno (o) o dos (t)
  Tipo de anillo | telaraña (c), evanescente (e), abocinado (f), grande (l), ninguno (n), colgante (p), revestimiento (s) o zona (z)
  Color de las esporas | negro (k), marrón (n), ante (b), chocolate (h), verde (r), naranja (o), morado (u), blanco (w) o amarillo (y)
  Población | abundante (a), agrupada (c), numerosa (n), dispersa (s), varias (v) o solitaria (y)
  Habitat | pastos (g), hojas (l), prados (m), caminos (p), urbano (u), desechos (w) o bosques (d)

Vamos a llamar a las variables como la caracteristica que ejemplifican.
```{r nombre de variables}
colnames(datos.setas)=c("Letalidad","Forma_S","Cuticula","Color_S","Escamas","Olor","Fijacion_L","Espacio_L","Tamaño_L","Color_L","Forma_T","Tallo_raiz","Superficie_T1","Superficie_T2","Color_T1","Color_T2","Tipo_V","Color_V","N_anillos","Tipo_anillo","Color_esporas","Poblacion","Habitat")
```

##  Particiones.

```{r particiones}
n_totales=dim(datos.setas)[1]
n_train=floor(n_totales*0.6) # el 60% de los datos los utilizamos para entrenar los modelos
n_test=floor(n_totales*0.2) # el 20% para test
n_validacion=n_totales-n_train-n_test

set.seed(34735)

indices_totales=seq(1:n_totales)
indices_train=sort(sample(indices_totales,n_train))
indices_test=sort(sample(indices_totales[-indices_train],n_test))
indices_validacion=indices_totales[-c(indices_train,indices_test)]


datos.setas_train=datos.setas[indices_train,]
datos.setas_test=datos.setas[indices_test,]
datos.setas_validacion=datos.setas[indices_validacion,]

```

#  Preprocesado de datos.

Para poder tranformar las variables en factor, lo haremos mediante **as.factor()** a todas las variables de los datos.
```{r factores, echo=FALSE}
#VARIABLE RESPUESTA
datos.setas_train$Letalidad=as.factor(datos.setas_train$Letalidad)
#VARIABLE 1
datos.setas_train$Forma_S=as.factor(datos.setas_train$Forma_S)
#VARIABLE 2
datos.setas_train$Cuticula=as.factor(datos.setas_train$Cuticula)
#VARIABLE 3
datos.setas_train$Color_S=as.factor(datos.setas_train$Color_S)
#VARIABLE 4
datos.setas_train$Escamas=as.factor(datos.setas_train$Escamas)
#VARIABLE 5
datos.setas_train$Olor=as.factor(datos.setas_train$Olor)
#VARIABLE 6
datos.setas_train$Fijacion_L=as.factor(datos.setas_train$Fijacion_L)
#VARIABLE 7
datos.setas_train$Espacio_L=as.factor(datos.setas_train$Espacio_L)
#VARIABLE 8
datos.setas_train$Tamaño_L=as.factor(datos.setas_train$Tamaño_L)
#VARIABLE 9
datos.setas_train$Color_L=as.factor(datos.setas_train$Color_L)
#VARIABLE 10
datos.setas_train$Forma_T=as.factor(datos.setas_train$Forma_T)
#VARIABLE 11
datos.setas_train$Tallo_raiz=as.factor(datos.setas_train$Tallo_raiz)
#VARIABLE 12
datos.setas_train$Superficie_T1=as.factor(datos.setas_train$Superficie_T1)
#VARIABLE 13
datos.setas_train$Superficie_T2=as.factor(datos.setas_train$Superficie_T2)
#VARIABLE 14
datos.setas_train$Color_T1=as.factor(datos.setas_train$Color_T1)
#VARIABLE 15
datos.setas_train$Color_T2=as.factor(datos.setas_train$Color_T2)
#VARIABLE 16
datos.setas_train$Tipo_V=as.factor(datos.setas_train$Tipo_V)
#VARIABLE 17
datos.setas_train$Color_V=as.factor(datos.setas_train$Color_V)
#VARIABLE 18
datos.setas_train$N_anillos=as.factor(datos.setas_train$N_anillos)
#VARIABLE 19
datos.setas_train$Tipo_anillo=as.factor(datos.setas_train$Tipo_anillo)
#VARIABLE 20
datos.setas_train$Color_esporas=as.factor(datos.setas_train$Color_esporas)
#VARIABLE 21
datos.setas_train$Poblacion=as.factor(datos.setas_train$Poblacion)
#VARIABLE 22
datos.setas_train$Habitat=as.factor(datos.setas_train$Habitat)
```

Ahora podemos ver mejor como son nuestros datos.
```{r resumen datos,echo=TRUE}
summary(datos.setas_train)
```
Una de las variables, **Tipo_v** (tipo de volva) con dos niveles distintos, parcial (p) y universal (u), podríamos eliminarla de nuestros datos pues todo la frecuencia solo está en uno de los niveles, luego no aporta información alguna para determinar si es venenosa o comestible.

```{r eliminar variable}
datos.setas_train=datos.setas_train[,-17]
```

Además, la variable **Fijacion_L** tendría solo dos niveles pues en el nivel descendente y entallado no aparecen en los datos y la variable **Espacio_L** también tiene dos niveles pues el nivel distante tampoco aparece, por ello las codificamos mediante unas variable binomiales.

Codificamos el resto de las variables originales de forma que obtendremos también nuevas variables binomiales, excepto las variables relacionadas con el color que las codificaremos siguiendo la escala de colores.
```{r codificación,echo=FALSE}
#Variable respuesta: venenosa-1 comestible-0
setas=data.frame(matrix(ncol=1))
colnames(setas)=c("Venenosas")

for(i in 1:dim(datos.setas_train)[1]){
  if(datos.setas_train[i,1]=="e"){
    setas=rbind(setas,c(0))
  }
  if(datos.setas_train[i,1]=="p"){
    setas=rbind(setas,c(1))
  }
}

#Variable 1: forma del sombrero
sombrero=matrix(ncol=6)
colnames(sombrero)=c("Campana","Cónica","Convexa","Plana","Nudosa","Hundida")

for(i in 1:dim(datos.setas_train)[1]){
  if(datos.setas_train[i,2]=="b"){
    sombrero=rbind(sombrero,c(1,0,0,0,0,0))
  }
  if(datos.setas_train[i,2]=="c"){
    sombrero=rbind(sombrero,c(0,1,0,0,0,0))
  }
  if(datos.setas_train[i,2]=="x"){
    sombrero=rbind(sombrero,c(0,0,1,0,0,0))
  }
  if(datos.setas_train[i,2]=="f"){
    sombrero=rbind(sombrero,c(0,0,0,1,0,0))
  }
  if(datos.setas_train[i,2]=="k"){
    sombrero=rbind(sombrero,c(0,0,0,0,1,0))
  }
  if(datos.setas_train[i,2]=="s"){
    sombrero=rbind(sombrero,c(0,0,0,0,0,1))
  }
}
setas=cbind(setas,sombrero)

#Variable 2: superficie del sombrero
superficie=matrix(ncol=4)
colnames(superficie)=c("Fibroso","Surcos","Escamoso","Liso")

for(i in 1:dim(datos.setas_train)[1]){
  if(datos.setas_train[i,3]=="f"){
    superficie=rbind(superficie,c(1,0,0,0))
  }
  if(datos.setas_train[i,3]=="g"){
    superficie=rbind(superficie,c(0,1,0,0))
  }
  if(datos.setas_train[i,3]=="y"){
    superficie=rbind(superficie,c(0,0,1,0))
  }
  if(datos.setas_train[i,3]=="s"){
    superficie=rbind(superficie,c(0,0,0,1))
  }
}
setas=cbind(setas,superficie)

#Variable 3: color del sombrero
color_sombrero=matrix(ncol=10)
colnames(color_sombrero)=c("S_Marrón","S_Ante","S_Canela","S_Gris","S_Verde","S_Rosa","S_Morado","S_Rojo","S_Blanco","S_Amarillo")

for(i in 1:dim(datos.setas_train)[1]){
  if(datos.setas[i,4]=="n"){
    color_sombrero=rbind(color_sombrero,c(1,0,0,0,0,0,0,0,0,0))
  }
  if(datos.setas[i,4]=="b"){
    color_sombrero=rbind(color_sombrero,c(0,1,0,0,0,0,0,0,0,0))
  }
  if(datos.setas[i,4]=="c"){
    color_sombrero=rbind(color_sombrero,c(0,0,1,0,0,0,0,0,0,0))
  }
  if(datos.setas[i,4]=="g"){
    color_sombrero=rbind(color_sombrero,c(0,0,0,1,0,0,0,0,0,0))
  }
  if(datos.setas[i,4]=="r"){
    color_sombrero=rbind(color_sombrero,c(0,0,0,0,1,0,0,0,0,0))
  }
  if(datos.setas[i,4]=="p"){
    color_sombrero=rbind(color_sombrero,c(0,0,0,0,0,1,0,0,0,0))
  }
  if(datos.setas[i,4]=="u"){
    color_sombrero=rbind(color_sombrero,c(0,0,0,0,0,0,1,0,0,0))
  }
  if(datos.setas[i,4]=="e"){
    color_sombrero=rbind(color_sombrero,c(0,0,0,0,0,0,0,1,0,0))
  }
  if(datos.setas[i,4]=="w"){
    color_sombrero=rbind(color_sombrero,c(0,0,0,0,0,0,0,0,1,0))
  }
  if(datos.setas[i,4]=="y"){
    color_sombrero=rbind(color_sombrero,c(0,0,0,0,0,0,0,0,0,1))
  }
}
setas=cbind(setas,color_sombrero)

#Variable 4: Escamas (true-1 false-0) prueba
escamas_S=matrix(ncol=1)
colnames(escamas_S)=c("Escamas")

for(i in 1:dim(datos.setas_train)[1]){
  if(datos.setas_train[i,5]=="f"){
    escamas_S=rbind(escamas_S,c(0))
  }
  if(datos.setas_train[i,5]=="t"){
    escamas_S=rbind(escamas_S,c(1))
  }
}
setas=cbind(setas,escamas_S)

#Variable 5: olor
olor=matrix(ncol=9)
colnames(olor)=c("O_almendra","O_anís","O_creosota","O_pescado","O_asqueroso","O_mohoso","O_ninguno","O_acre","O_picante")

for(i in 1:dim(datos.setas_train)[1]){
  if(datos.setas_train[i,6]=="a"){
    olor=rbind(olor,c(1,0,0,0,0,0,0,0,0))
  }
  if(datos.setas_train[i,6]=="l"){
    olor=rbind(olor,c(0,1,0,0,0,0,0,0,0))
  }
  if(datos.setas_train[i,6]=="c"){
    olor=rbind(olor,c(0,0,1,0,0,0,0,0,0))
  }
  if(datos.setas_train[i,6]=="y"){
    olor=rbind(olor,c(0,0,0,1,0,0,0,0,0))
  }
  if(datos.setas_train[i,6]=="f"){
    olor=rbind(olor,c(0,0,0,0,1,0,0,0,0))
  }
  if(datos.setas_train[i,6]=="m"){
    olor=rbind(olor,c(0,0,0,0,0,1,0,0,0))
  }
  if(datos.setas_train[i,6]=="n"){
    olor=rbind(olor,c(0,0,0,0,0,0,1,0,0))
  }
  if(datos.setas_train[i,6]=="p"){
    olor=rbind(olor,c(0,0,0,0,0,0,0,1,0))
  }
  if(datos.setas_train[i,6]=="s"){
    olor=rbind(olor,c(0,0,0,0,0,0,0,0,1))
  }
}
setas=cbind(setas,olor)

#Varibale 6: fijación de láminas (adjunto-1 libre-0)
fijacion_laminas=matrix(ncol=1)
colnames(fijacion_laminas)=c("Adjunto/Libre")

for(i in 1:dim(datos.setas_train)[1]){
  if(datos.setas_train[i,7]=="a"){
    fijacion_laminas=rbind(fijacion_laminas,c(1))
  }
  if(datos.setas_train[i,7]=="f"){
    fijacion_laminas=rbind(fijacion_laminas,c(0))
  }
}
setas=cbind(setas,fijacion_laminas)

#Variable 7: espacio entre láminas (cerca-1 atestado-0)
espacio_laminas=matrix(ncol=1)
colnames(espacio_laminas)=c("Cerca/Atestado")

for(i in 1:dim(datos.setas_train)[1]){
  if(datos.setas_train[i,8]=="c"){
    espacio_laminas=rbind(espacio_laminas,c(1))
  }
  if(datos.setas_train[i,8]=="w"){
    espacio_laminas=rbind(espacio_laminas,c(0))
  }
}
setas=cbind(setas,espacio_laminas)

#Variable 8: tamaño de láminas (ancho-1 estrecho-0)
tamaño_laminas=matrix(ncol=1)
colnames(tamaño_laminas)=c("Ancho/Estrecho")

for(i in 1:dim(datos.setas_train)[1]){
  if(datos.setas_train[i,9]=="b"){
    tamaño_laminas=rbind(tamaño_laminas,c(1))
  }
  if(datos.setas_train[i,9]=="n"){
    tamaño_laminas=rbind(tamaño_laminas,c(0))
  }
}
setas=cbind(setas,tamaño_laminas)

#Variable 9: color de láminas
color_laminas=matrix(ncol=12)
colnames(color_laminas)=c("L_Negro","L_Marrón","L_Canela","L_Chocolate","L_Gris","L_Verde","L_Naranja","L_Rosa","L_Morado","L_Rojo","L_Blanco","L_Amarillo")

for(i in 1:dim(datos.setas_train)[1]){
  if(datos.setas[i,10]=="k"){
    color_laminas=rbind(color_laminas,c(1,0,0,0,0,0,0,0,0,0,0,0))
  }
  if(datos.setas[i,10]=="n"){
    color_laminas=rbind(color_laminas,c(0,1,0,0,0,0,0,0,0,0,0,0))
  }
  if(datos.setas[i,10]=="b"){
    color_laminas=rbind(color_laminas,c(0,0,1,0,0,0,0,0,0,0,0,0))
  }
  if(datos.setas[i,10]=="h"){
    color_laminas=rbind(color_laminas,c(0,0,0,1,0,0,0,0,0,0,0,0))
  }
  if(datos.setas[i,10]=="g"){
    color_laminas=rbind(color_laminas,c(0,0,0,0,1,0,0,0,0,0,0,0))
  }
  if(datos.setas[i,10]=="r"){
    color_laminas=rbind(color_laminas,c(0,0,0,0,0,1,0,0,0,0,0,0))
  }
  if(datos.setas[i,10]=="o"){
    color_laminas=rbind(color_laminas,c(0,0,0,0,0,0,1,0,0,0,0,0))
  }
  if(datos.setas[i,10]=="p"){
    color_laminas=rbind(color_laminas,c(0,0,0,0,0,0,0,1,0,0,0,0))
  }
  if(datos.setas[i,10]=="u"){
    color_laminas=rbind(color_laminas,c(0,0,0,0,0,0,0,0,1,0,0,0))
  }
  if(datos.setas[i,10]=="e"){
    color_laminas=rbind(color_laminas,c(0,0,0,0,0,0,0,0,0,1,0,0))
  }
  if(datos.setas[i,10]=="w"){
    color_laminas=rbind(color_laminas,c(0,0,0,0,0,0,0,0,0,0,1,0))
  }
  if(datos.setas[i,10]=="y"){
    color_laminas=rbind(color_laminas,c(0,0,0,0,0,0,0,0,0,0,0,1))
  }
}
setas=cbind(setas,color_laminas)

#Variable 10: forma del tallo (agrandado-1 afilado-0)
forma_tallo=matrix(ncol=1)
colnames(forma_tallo)=c("Agrandado/Afilado")

for(i in 1:dim(datos.setas_train)[1]){
  if(datos.setas_train[i,11]=="e"){
    forma_tallo=rbind(forma_tallo,c(1))
  }
  if(datos.setas_train[i,11]=="t"){
    forma_tallo=rbind(forma_tallo,c(0))
  }
}
setas=cbind(setas,forma_tallo)

#Variable 11: tallo-raíz
tallo_r=matrix(ncol=7)
colnames(tallo_r)=c("TR_bulboso","TR_club","TR_copa","TR_igual","TR_rizomorfos","TR_enraizado","TR_faltante")

for(i in 1:dim(datos.setas_train)[1]){
  if(datos.setas_train[i,12]=="b"){
    tallo_r=rbind(tallo_r,c(1,0,0,0,0,0,0))
  }
  if(datos.setas_train[i,12]=="c"){
    tallo_r=rbind(tallo_r,c(0,1,0,0,0,0,0))
  }
  if(datos.setas_train[i,12]=="u"){
    tallo_r=rbind(tallo_r,c(0,0,1,0,0,0,0))
  }
  if(datos.setas_train[i,12]=="e"){
    tallo_r=rbind(tallo_r,c(0,0,0,1,0,0,0))
  }
  if(datos.setas_train[i,12]=="z"){
    tallo_r=rbind(tallo_r,c(0,0,0,0,1,0,0))
  }
  if(datos.setas_train[i,12]=="r"){
    tallo_r=rbind(tallo_r,c(0,0,0,0,0,1,0))
  }
  if(datos.setas_train[i,12]=="?"){
    tallo_r=rbind(tallo_r,c(0,0,0,0,0,0,1))
  }
}
setas=cbind(setas,tallo_r)

#Variable 12: superficie del tallo por encima del anillo
superficiet1=matrix(ncol=4)
colnames(superficiet1)=c("ST1_Fibroso","ST1_Escamoso","ST1_Sedoso","ST1_Liso")

for(i in 1:dim(datos.setas_train)[1]){
  if(datos.setas_train[i,13]=="f"){
    superficiet1=rbind(superficiet1,c(1,0,0,0))
  }
  if(datos.setas_train[i,13]=="y"){
    superficiet1=rbind(superficiet1,c(0,1,0,0))
  }
  if(datos.setas_train[i,13]=="k"){
    superficiet1=rbind(superficiet1,c(0,0,1,0))
  }
  if(datos.setas_train[i,13]=="s"){
    superficiet1=rbind(superficiet1,c(0,0,0,1))
  }
}
setas=cbind(setas,superficiet1)

#Variable 13: superficie del tallo por debajo del anillo
superficiet2=matrix(ncol=4)
colnames(superficiet2)=c("ST2_Fibroso","ST2_Escamoso","ST2_Sedoso","ST2_Liso")

for(i in 1:dim(datos.setas_train)[1]){
  if(datos.setas_train[i,14]=="f"){
    superficiet2=rbind(superficiet2,c(1,0,0,0))
  }
  if(datos.setas_train[i,14]=="y"){
    superficiet2=rbind(superficiet2,c(0,1,0,0))
  }
  if(datos.setas_train[i,14]=="k"){
    superficiet2=rbind(superficiet2,c(0,0,1,0))
  }
  if(datos.setas_train[i,14]=="s"){
    superficiet2=rbind(superficiet2,c(0,0,0,1))
  }
}
setas=cbind(setas,superficiet2)

#Variable 14: color del tallo por encima del anillo
color.t1=matrix(ncol=9)
colnames(color.t1)=c("CT1_marron","CT1_ante","CT1_canela","CT1_gris","CT1_naranja","CT1_rosa","CT1_rojo","CT1_blanco","CT1_amarillo")
for(i in 1:dim(datos.setas_train)[1]){
  if(datos.setas_train[i,15]=="n"){
    color.t1=rbind(color.t1,c(1,0,0,0,0,0,0,0,0))
  }
  if(datos.setas_train[i,15]=="b"){
    color.t1=rbind(color.t1,c(0,1,0,0,0,0,0,0,0))
  }
  if(datos.setas_train[i,15]=="c"){
    color.t1=rbind(color.t1,c(0,0,1,0,0,0,0,0,0))
  }
  if(datos.setas_train[i,15]=="g"){
    color.t1=rbind(color.t1,c(0,0,0,1,0,0,0,0,0))
  }
  if(datos.setas_train[i,15]=="o"){
    color.t1=rbind(color.t1,c(0,0,0,0,1,0,0,0,0))
  }
  if(datos.setas_train[i,15]=="p"){
    color.t1=rbind(color.t1,c(0,0,0,0,0,1,0,0,0))
  }
  if(datos.setas_train[i,15]=="e"){
    color.t1=rbind(color.t1,c(0,0,0,0,0,0,1,0,0))
  }
  if(datos.setas_train[i,15]=="w"){
    color.t1=rbind(color.t1,c(0,0,0,0,0,0,0,1,0))
  }
  if(datos.setas_train[i,15]=="y"){
    color.t1=rbind(color.t1,c(0,0,0,0,0,0,0,0,1))
  }
}
setas=cbind(setas,color.t1)
  


#Variable 15: color del tallo por debajo del anillo
color.t2=matrix(ncol=9)
colnames(color.t2)=c("CT2_marron","CT2_ante","CT2_canela","CT2_gris","CT2_naranja","CT2_rosa","CT2_rojo","CT2_blanco","CT2_amarillo")
for(i in 1:dim(datos.setas_train)[1]){
  if(datos.setas_train[i,16]=="n"){
    color.t2=rbind(color.t2,c(1,0,0,0,0,0,0,0,0))
  }
  if(datos.setas_train[i,16]=="b"){
    color.t2=rbind(color.t2,c(0,1,0,0,0,0,0,0,0))
  }
  if(datos.setas_train[i,16]=="c"){
    color.t2=rbind(color.t2,c(0,0,1,0,0,0,0,0,0))
  }
  if(datos.setas_train[i,16]=="g"){
    color.t2=rbind(color.t2,c(0,0,0,1,0,0,0,0,0))
  }
  if(datos.setas_train[i,16]=="o"){
    color.t2=rbind(color.t2,c(0,0,0,0,1,0,0,0,0))
  }
  if(datos.setas_train[i,16]=="p"){
    color.t2=rbind(color.t2,c(0,0,0,0,0,1,0,0,0))
  }
  if(datos.setas_train[i,16]=="e"){
    color.t2=rbind(color.t2,c(0,0,0,0,0,0,1,0,0))
  }
  if(datos.setas_train[i,16]=="w"){
    color.t2=rbind(color.t2,c(0,0,0,0,0,0,0,1,0))
  }
  if(datos.setas_train[i,16]=="y"){
    color.t2=rbind(color.t2,c(0,0,0,0,0,0,0,0,1))
  }
}
setas=cbind(setas,color.t2)

#Variable 16: color de la volva
color_volva=matrix(ncol=4)
colnames(color_volva)=c("V_Marrón","V_Naranja","V_Blanco","V_Amarillo")

for(i in 1:dim(datos.setas_train)[1]){
  if(datos.setas_train[i,17]=="n"){
    color_volva=rbind(color_volva,c(1,0,0,0))
  }
  if(datos.setas_train[i,17]=="o"){
    color_volva=rbind(color_volva,c(0,1,0,0))
  }
  if(datos.setas_train[i,17]=="w"){
    color_volva=rbind(color_volva,c(0,0,1,0))
  }
  if(datos.setas_train[i,17]=="y"){
    color_volva=rbind(color_volva,c(0,0,0,1))
  }
}
setas=cbind(setas,color_volva)

#Variable 17: número de anillos
nanillos=matrix(ncol=1)
colnames(nanillos)=c("Nº anillos")

for(i in 1:dim(datos.setas_train)[1]){
  if(datos.setas_train[i,18]=="n"){
    nanillos=rbind(nanillos,c(0))
  }
  if(datos.setas_train[i,18]=="o"){
    nanillos=rbind(nanillos,c(1))
  }
  if(datos.setas_train[i,18]=="t"){
    nanillos=rbind(nanillos,c(2))
  }
}
setas=cbind(setas,nanillos)

#Variable 18: tipo de anillo
tanillo=matrix(ncol=8)
colnames(tanillo)=c("TA_Telaraña","TA_Evanescente","TA_Abocinado","TA_Grande","TA_Ninguno","TA_Colgante","TA_Revestimiento","TA_Zona")

for(i in 1:dim(datos.setas_train)[1]){
  if(datos.setas_train[i,19]=="c"){
    tanillo=rbind(tanillo,c(1,0,0,0,0,0,0))
  }
  if(datos.setas_train[i,19]=="e"){
    tanillo=rbind(tanillo,c(0,1,0,0,0,0,0,0))
  }
  if(datos.setas_train[i,19]=="f"){
    tanillo=rbind(tanillo,c(0,0,1,0,0,0,0,0))
  }
  if(datos.setas_train[i,19]=="l"){
    tanillo=rbind(tanillo,c(0,0,0,1,0,0,0,0))
  }
  if(datos.setas_train[i,19]=="n"){
    tanillo=rbind(tanillo,c(0,0,0,0,1,0,0,0))
  }
  if(datos.setas_train[i,19]=="p"){
    tanillo=rbind(tanillo,c(0,0,0,0,0,1,0,0))
  }
  if(datos.setas_train[i,19]=="s"){
    tanillo=rbind(tanillo,c(0,0,0,0,0,0,1,0))
  }
  if(datos.setas_train[i,19]=="z"){
    tanillo=rbind(tanillo,c(0,0,0,0,0,0,0,1))
  }
}
setas=cbind(setas,tanillo)

#Variable 19: color de las esporas
color.e=matrix(ncol=9)
colnames(color.e)=c("CE_negro","CE_marron","CE_ante","CE_chocolate","CE_verde","CE_naranja","CE_morado","CE_blanco","CE_amarillo")
for(i in 1:dim(datos.setas_train)[1]){
  if(datos.setas_train[i,20]=="k"){
    color.e=rbind(color.e,c(1,0,0,0,0,0,0,0,0))
  }
  if(datos.setas_train[i,20]=="n"){
    color.e=rbind(color.e,c(0,1,0,0,0,0,0,0,0))
  }
  if(datos.setas_train[i,20]=="b"){
    color.e=rbind(color.e,c(0,0,1,0,0,0,0,0,0))
  }
  if(datos.setas_train[i,20]=="h"){
    color.e=rbind(color.e,c(0,0,0,1,0,0,0,0,0))
  }
  if(datos.setas_train[i,20]=="r"){
    color.e=rbind(color.e,c(0,0,0,0,1,0,0,0,0))
  }
  if(datos.setas_train[i,20]=="o"){
    color.e=rbind(color.e,c(0,0,0,0,0,1,0,0,0))
  }
  if(datos.setas_train[i,20]=="u"){
    color.e=rbind(color.e,c(0,0,0,0,0,0,1,0,0))
  }
  if(datos.setas_train[i,20]=="w"){
    color.e=rbind(color.e,c(0,0,0,0,0,0,0,1,0))
  }
  if(datos.setas_train[i,20]=="y"){
    color.e=rbind(color.e,c(0,0,0,0,0,0,0,0,1))
  }
}
setas=cbind(setas,color.e)

#Variable 20: población
poblation=matrix(ncol=6)
colnames(poblation)=c("Abundante", "Agrupada", "Numerosa", "Dispersa", "Varias", "Solitaria")

for(i in 1:dim(datos.setas_train)[1]){
  if(datos.setas_train[i,21]=="a"){
    poblation=rbind(poblation,c(1,0,0,0,0,0))
  }
  if(datos.setas_train[i,21]=="c"){
    poblation=rbind(poblation,c(0,1,0,0,0,0))
  }
  if(datos.setas_train[i,21]=="n"){
    poblation=rbind(poblation,c(0,0,1,0,0,0))
  }
  if(datos.setas_train[i,21]=="s"){
    poblation=rbind(poblation,c(0,0,0,1,0,0))
  }
  if(datos.setas_train[i,21]=="v"){
    poblation=rbind(poblation,c(0,0,0,0,1,0))
  }
  if(datos.setas_train[i,21]=="y"){
    poblation=rbind(poblation,c(0,0,0,0,0,1))
  }
}
setas=cbind(setas,poblation)

#Variable 21: habitat
habita=matrix(ncol=7)
colnames(habita)=c("bosques", "pastos", "hojas", "prados", "caminos", "urbano", "desechos")

for(i in 1:dim(datos.setas_train)[1]){
  if(datos.setas_train[i,22]=="d"){
    habita=rbind(habita,c(1,0,0,0,0,0,0))
  }
  if(datos.setas_train[i,22]=="g"){
    habita=rbind(habita,c(0,1,0,0,0,0,0))
  }
  if(datos.setas_train[i,22]=="l"){
    habita=rbind(habita,c(0,0,1,0,0,0,0))
  }
  if(datos.setas_train[i,22]=="m"){
    habita=rbind(habita,c(0,0,0,1,0,0,0))
  }
  if(datos.setas_train[i,22]=="p"){
    habita=rbind(habita,c(0,0,0,0,1,0,0))
  }
  if(datos.setas_train[i,22]=="u"){
    habita=rbind(habita,c(0,0,0,0,0,1,0))
  }
  if(datos.setas_train[i,22]=="w"){
    habita=rbind(habita,c(0,0,0,0,0,0,1))
  }
}
setas=cbind(setas,habita)

setas=setas[-1,]
rownames(setas)=as.character(seq(1:n_train))
```

```{r datos codificados,echo=TRUE}
#6 primeras observaciones de los datos ya codificados
head(setas)

#Dimensión
dim(setas)
```

##  EDA. Exploratory Data Analysis.

### Letalidad:
La variable **letalidad** tiene dos niveles distintos, venenosa (p) o comestible (e), la frecuencia relativa correspondiente a nuestros datos es:
```{r proporcion, echo=TRUE}
#Tabla:
table(setas$Venenosas)
#Tabla de frecuencias:
prop.table(table(setas$Venenosas))
#Gráfico
barplot(table(setas$Venenosas),main="Letalidad",ylab="Número de setas",col=c("blue","magenta"),names.arg=c("Comestible","Venenosa"))
```



##  Correlación entre las variables.

Vamos a comprobar si existe alguna correlación entre las distintas variables. 

### Forma del sombrero (Forma_S)

```{r forma del sombrero,echo=TRUE}
#Tabla de frecuencias letalidad~forma del sombrero
table(datos.setas_train$Letalidad,datos.setas_train$Forma_S)
#Gráfico letalidad~forma del sombrero
barplot(table(datos.setas_train$Letalidad,datos.setas_train$Forma_S),main="Letalidad",xlab="Forma_S",ylab="Número de setas",names.arg=c("campana", "cónica", "convexa", "plana", "nudosa", "hundida"),col=c("blue","magenta"))
```

### Habitat

```{r habitat,echo=TRUE}
#Tabla de frecuencias letalidad~habitat
table(datos.setas_train$Letalidad,datos.setas_train$Habitat)
#Gráfico letalidad~habitat
barplot(table(datos.setas_train$Letalidad,datos.setas_train$Habitat),main="Letalidad",xlab="Habitat",ylab="Número de setas",names.arg=c("bosques", "pastos", "hojas", "prados", "caminos", "urbano", "desechos"),col=c("blue","magenta"))
#legend(x = "topright", legend = c("Comestible","Venenosa"), fill = c("blue", "magenta"))
```

### Población

```{r poblacion,echo=TRUE}
#Tabla de frecuencias letalidad~poblacion
table(datos.setas_train$Letalidad,datos.setas_train$Poblacion)
#Gráfico letalidad~poblacion
barplot(table(datos.setas_train$Letalidad,datos.setas_train$Poblacion),main="Letalidad",xlab="Poblacion",ylab="Número de setas",names.arg=c("abundante", "agrupada", "numerosa", "dispersa", "varias", "solitaria"),col=c("blue","magenta"))
#legend(x = "topright", legend = c("Comestible","Venenosa"), fill = c("blue", "magenta"))
```

##  Transformación de variables

##  Imputacion de datos (datos faltantes)

#  Modelado

##  k-NN
##  Regresión Logística
##  Clustering
##  Arboles de Decisión
##  Bosques Aleatorios
##  Support Vector Machines
##  Redes Neuronales

#  Evaluación


#  Visualización y Presentación de Resultados

#  Puesta en producción
OJO!!! al inicio del estudio, necesitamos reservar parte de la bases de datos para esta etapa. Nos referiremos a esa parte como "los datos guardados en un cajón". Normalmente esta etapa se hace "el último día de clase".

#  Actualización del modelo...
Vuelta a empezar.